<div class="container my-4">
  <h2>Fotos de la propiedad</h2>
  <p class="text-muted">
    Propiedad:
    <strong>{{ propiedadTitulo || ('ID ' + propiedadId) }}</strong>
  </p>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <!-- Subir nueva foto -->
  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title">Subir nueva foto</h5>
      <p class="card-text">
        Formatos permitidos: JPG, PNG. El peso máximo depende de la
        configuración del servidor.
      </p>

      <input
        type="file"
        class="form-control"
        (change)="onFileSelected($event)"
        [disabled]="subiendo"
        accept="image/*"
      />

      <small class="text-muted" *ngIf="subiendo">
        Subiendo foto...
      </small>
    </div>
  </div>

  <!-- Listado de fotos -->
  <div *ngIf="cargando" class="text-muted">Cargando fotos...</div>

  <div
    *ngIf="!cargando && fotos.length === 0"
    class="alert alert-info"
  >
    Aún no has subido fotos para esta propiedad.
  </div>

  <div class="row g-3" *ngIf="!cargando && fotos.length > 0">
    <div
      class="col-12 col-sm-6 col-md-4 col-lg-3"
      *ngFor="let f of fotos"
    >
      <div class="card h-100 shadow-sm">
        <img
          [src]="f.url"
          class="card-img-top"
          alt="Foto propiedad"
          style="object-fit: cover; height: 180px;"
        />
        <div class="card-body d-flex flex-column">
          <div class="mb-2">
            <span
              class="badge"
              [ngClass]="f.principal ? 'bg-success' : 'bg-secondary'"
            >
              {{ f.principal ? 'Principal' : 'Secundaria' }}
            </span>
          </div>

          <div class="mt-auto d-flex justify-content-between gap-1">
            <button
              type="button"
              class="btn btn-sm btn-outline-success"
              (click)="marcarPrincipal(f)"
              [disabled]="f.principal"
            >
              Hacer principal
            </button>
            <button
              type="button"
              class="btn btn-sm btn-outline-danger"
              (click)="eliminarFoto(f)"
            >
              Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-4">
    <a class="btn btn-outline-secondary" [routerLink]="['/mis-propiedades']">
      Volver al panel de propietario
    </a>
  </div>
</div>
